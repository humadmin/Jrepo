---
  - hosts: all
    vars:
      db_package: mariadb-server
      db_service: mariadb
      db_users:
        - db_admin
        - db_user

      configure_database_path: /etc/my.cnf

    tasks:
    - name: create the MariaDB users
      user:
        name: "{{ item }}"
      with_items: "{{ db_users }}"
      when: inventory_hostname in groups['redhat']

    - name: Install Mariadb server
      yum:
        name: "{{ db_package }}"
      when: db_package is defined 

    - name: Configure Database software
      include: config_db.yml
      vars:
        extra_package:
          - mariadb-bench
          - mariadb-libs
          - mariadb-test

      when: configure_database_path is defined 
      
